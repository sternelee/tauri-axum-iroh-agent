# iroh P2Pæ¨¡å—æ¶æ„å®¡æ ¸æŠ¥å‘Š

## ğŸ“‹ æ€»ä½“è¯„ä¼°

ç»è¿‡å…¨é¢å®¡æ ¸ï¼Œå½“å‰åŸºäºirohçš„P2Pæ–‡ä»¶ä¼ è¾“å’Œå®æ—¶èŠå¤©æ¨¡å—å®ç°å…·æœ‰è‰¯å¥½çš„æ¶æ„è®¾è®¡å’Œé€šç”¨æ€§ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†çš„åˆ†æå’Œæ”¹è¿›å»ºè®®ã€‚

## âœ… æ¶æ„ä¼˜åŠ¿

### 1. æ¨¡å—åŒ–è®¾è®¡
- **æ¸…æ™°çš„åˆ†å±‚æ¶æ„**: æ ¸å¿ƒé€»è¾‘ã€é€‚é…å™¨å±‚ã€ç±»å‹å®šä¹‰åˆ†ç¦»æ˜ç¡®
- **å•ä¸€èŒè´£åŸåˆ™**: æ¯ä¸ªæ¨¡å—èŒè´£æ˜ç¡®ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•
- **ä¾èµ–æ³¨å…¥**: é€šè¿‡é…ç½®å’Œå›è°ƒå‡½æ•°å®ç°çµæ´»çš„ä¾èµ–ç®¡ç†

### 2. é€šç”¨æ€§è®¾è®¡
- **è·¨å¹³å°æ”¯æŒ**: ä¸ä¾èµ–ç‰¹å®šUIæ¡†æ¶ï¼Œå¯åœ¨å¤šç§ç¯å¢ƒä¸­ä½¿ç”¨
- **é€‚é…å™¨æ¨¡å¼**: æ”¯æŒtauriã€axumã€ç‹¬ç«‹è¿è¡Œç­‰å¤šç§ç¯å¢ƒ
- **é…ç½®é©±åŠ¨**: é€šè¿‡é…ç½®æ–‡ä»¶å’Œæ„å»ºå™¨æ¨¡å¼å®ç°çµæ´»é…ç½®

### 3. ç±»å‹å®‰å…¨
- **å®Œæ•´çš„é”™è¯¯å¤„ç†**: ä½¿ç”¨thiserroræä¾›ç»“æ„åŒ–é”™è¯¯ç±»å‹
- **ç±»å‹å®‰å…¨çš„API**: åˆ©ç”¨Rustç±»å‹ç³»ç»Ÿç¡®ä¿ç¼–è¯‘æ—¶å®‰å…¨
- **å¼‚æ­¥æ”¯æŒ**: åŸºäºtokioçš„ç°ä»£å¼‚æ­¥ç¼–ç¨‹æ¨¡å¼

### 4. åŠŸèƒ½å®Œæ•´æ€§
- **æ–‡ä»¶ä¼ è¾“**: æ”¯æŒP2Pæ–‡ä»¶ä¸Šä¼ ã€ä¸‹è½½ã€åˆ†äº«
- **å®æ—¶èŠå¤©**: åŸºäºiroh gossipåè®®çš„å»ä¸­å¿ƒåŒ–èŠå¤©
- **è¿›åº¦é€šçŸ¥**: å®Œæ•´çš„ä¼ è¾“å’ŒèŠå¤©äº‹ä»¶å›è°ƒç³»ç»Ÿ
- **æ–‡ä»¶åˆ†äº«é›†æˆ**: èŠå¤©ä¸­ç›´æ¥åˆ†äº«å’Œä¸‹è½½æ–‡ä»¶

## ğŸ”§ å·²ä¿®å¤çš„é—®é¢˜

### 1. ç¼–è¯‘é”™è¯¯ä¿®å¤
```rust
// ä¿®å¤å‰ï¼šæœªå®šä¹‰çš„gossipå­—æ®µ
let mut gossip_stream = self.gossip.subscribe(room.topic_id).await?;

// ä¿®å¤åï¼šæ­£ç¡®ä½¿ç”¨iroh_client
let mut gossip_stream = self.iroh_client.gossip().subscribe(room.topic_id).await?;
```

### 2. èµ„æºç®¡ç†æ”¹è¿›
```rust
// æ”¹è¿›å‰ï¼šç®€å•çš„Noneèµ‹å€¼
pub fn disable_chat(&mut self) {
    self.chat_client = None;
}

// æ”¹è¿›åï¼šä¼˜é›…çš„èµ„æºæ¸…ç†
pub async fn disable_chat(&mut self) -> TransferResult<()> {
    if let Some(chat_client) = self.chat_client.take() {
        // ç¦»å¼€æ‰€æœ‰èŠå¤©å®¤ï¼Œæ¸…ç†èµ„æº
        let rooms = chat_client.get_joined_rooms();
        for room in rooms {
            let _ = chat_client.leave_room(LeaveRoomRequest {
                room_id: room.id,
            }).await;
        }
    }
    Ok(())
}
```

## ğŸš€ æ¶æ„åˆç†æ€§åˆ†æ

### 1. æ ¸å¿ƒå®¢æˆ·ç«¯è®¾è®¡
```rust
pub struct IrohIntegratedClient {
    transfer_client: Arc<IrohClient>,      // æ–‡ä»¶ä¼ è¾“å®¢æˆ·ç«¯
    chat_client: Option<Arc<IrohChatClient>>, // å¯é€‰çš„èŠå¤©å®¢æˆ·ç«¯
    transfer_config: TransferConfig,        // ä¼ è¾“é…ç½®
    chat_config: ChatConfig,               // èŠå¤©é…ç½®
}
```

**ä¼˜ç‚¹**:
- ç»„åˆæ¨¡å¼ï¼šæ–‡ä»¶ä¼ è¾“å’ŒèŠå¤©åŠŸèƒ½ç‹¬ç«‹ä½†å¯ååŒå·¥ä½œ
- å¯é€‰åŠŸèƒ½ï¼šèŠå¤©åŠŸèƒ½å¯æŒ‰éœ€å¯ç”¨/ç¦ç”¨
- é…ç½®åˆ†ç¦»ï¼šä¸åŒåŠŸèƒ½çš„é…ç½®ç‹¬ç«‹ç®¡ç†

### 2. é€‚é…å™¨æ¨¡å¼å®ç°
```rust
// ç‹¬ç«‹é€‚é…å™¨
pub struct StandaloneAdapter { /* ... */ }

// Taurié€‚é…å™¨
pub struct TauriAdapter<E: TauriEventEmitter> { /* ... */ }

// Axumé€‚é…å™¨
pub struct AxumAdapter { /* ... */ }
```

**ä¼˜ç‚¹**:
- ç¯å¢ƒè§£è€¦ï¼šæ ¸å¿ƒé€»è¾‘ä¸è¿è¡Œç¯å¢ƒåˆ†ç¦»
- æ˜“äºæ‰©å±•ï¼šå¯è½»æ¾æ·»åŠ æ–°çš„è¿è¡Œç¯å¢ƒæ”¯æŒ
- æ¥å£ç»Ÿä¸€ï¼šä¸åŒé€‚é…å™¨æä¾›ä¸€è‡´çš„API

### 3. äº‹ä»¶ç³»ç»Ÿè®¾è®¡
```rust
pub enum TransferEvent {
    UploadProgress { id: String, offset: u64 },
    DownloadProgress { id: String, offset: u64 },
    // ...
}

pub enum ChatEvent {
    MessageReceived(ChatMessage),
    UserJoined(ChatUser),
    // ...
}
```

**ä¼˜ç‚¹**:
- ç±»å‹å®‰å…¨ï¼šä½¿ç”¨æšä¸¾ç¡®ä¿äº‹ä»¶ç±»å‹å®‰å…¨
- æ‰©å±•æ€§ï¼šæ˜“äºæ·»åŠ æ–°çš„äº‹ä»¶ç±»å‹
- ç»Ÿä¸€å¤„ç†ï¼šæä¾›ä¸€è‡´çš„äº‹ä»¶å¤„ç†æœºåˆ¶

## ğŸ“ˆ é€šç”¨æ€§è¯„ä¼°

### 1. è·¨å¹³å°å…¼å®¹æ€§ â­â­â­â­â­
- âœ… æ”¯æŒWindowsã€macOSã€Linux
- âœ… ä¸ä¾èµ–ç‰¹å®šçš„GUIæ¡†æ¶
- âœ… å¯åœ¨æœåŠ¡å™¨å’Œæ¡Œé¢ç¯å¢ƒä¸­è¿è¡Œ

### 2. é›†æˆä¾¿åˆ©æ€§ â­â­â­â­â­
```rust
// ç®€å•é›†æˆç¤ºä¾‹
let client = IntegratedClientBuilder::new()
    .transfer_config(config)
    .enable_chat(true)
    .build()
    .await?;
```

### 3. æ‰©å±•æ€§ â­â­â­â­â­
- âœ… æ¨¡å—åŒ–è®¾è®¡ä¾¿äºåŠŸèƒ½æ‰©å±•
- âœ… é€‚é…å™¨æ¨¡å¼æ”¯æŒæ–°ç¯å¢ƒ
- âœ… äº‹ä»¶ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰å¤„ç†

### 4. æ€§èƒ½è¡¨ç° â­â­â­â­â­
- âœ… åŸºäºtokioçš„é«˜æ€§èƒ½å¼‚æ­¥IO
- âœ… irohæä¾›çš„é«˜æ•ˆP2Pä¼ è¾“
- âœ… æµå¼å¤„ç†æ”¯æŒå¤§æ–‡ä»¶ä¼ è¾“

## ğŸ”® æ”¹è¿›å»ºè®®

### 1. è¿æ¥ç®¡ç†ä¼˜åŒ–
```rust
// å»ºè®®æ·»åŠ è¿æ¥æ± ç®¡ç†
pub struct ConnectionManager {
    max_connections: usize,
    active_connections: HashMap<String, Connection>,
    connection_timeout: Duration,
}
```

### 2. é…ç½®éªŒè¯å¢å¼º
```rust
impl TransferConfig {
    pub fn validate(&self) -> TransferResult<()> {
        // éªŒè¯æ•°æ®ç›®å½•æƒé™
        // éªŒè¯ä¸‹è½½ç›®å½•å¯å†™æ€§
        // éªŒè¯é…ç½®å‚æ•°åˆç†æ€§
    }
}
```

### 3. ç›‘æ§å’ŒæŒ‡æ ‡
```rust
pub struct Metrics {
    pub active_transfers: u64,
    pub active_chat_rooms: u64,
    pub total_bytes_transferred: u64,
    pub messages_sent: u64,
}
```

### 4. å®‰å…¨æ€§å¢å¼º
```rust
pub struct SecurityConfig {
    pub max_file_size: u64,
    pub allowed_file_types: Vec<String>,
    pub rate_limit: RateLimit,
    pub encryption_enabled: bool,
}
```

## ğŸ“Š æ€§èƒ½åŸºå‡†æµ‹è¯•å»ºè®®

### 1. æ–‡ä»¶ä¼ è¾“æ€§èƒ½
- ä¸åŒæ–‡ä»¶å¤§å°çš„ä¼ è¾“é€Ÿåº¦æµ‹è¯•
- å¹¶å‘ä¼ è¾“æ€§èƒ½æµ‹è¯•
- ç½‘ç»œæ¡ä»¶å¯¹ä¼ è¾“çš„å½±å“

### 2. èŠå¤©æ€§èƒ½
- æ¶ˆæ¯å»¶è¿Ÿæµ‹è¯•
- å¤§é‡ç”¨æˆ·å¹¶å‘èŠå¤©æµ‹è¯•
- æ¶ˆæ¯å†å²æŸ¥è¯¢æ€§èƒ½

### 3. å†…å­˜ä½¿ç”¨
- é•¿æ—¶é—´è¿è¡Œçš„å†…å­˜æ³„æ¼æ£€æµ‹
- å¤§æ–‡ä»¶ä¼ è¾“æ—¶çš„å†…å­˜ä½¿ç”¨
- èŠå¤©å†å²çš„å†…å­˜ç®¡ç†

## ğŸ¯ æ€»ç»“

å½“å‰çš„iroh P2Pæ¨¡å—å®ç°å±•ç°äº†ä¼˜ç§€çš„æ¶æ„è®¾è®¡ï¼š

1. **æ¨¡å—åŒ–ç¨‹åº¦é«˜**: æ¸…æ™°çš„åˆ†å±‚å’ŒèŒè´£åˆ†ç¦»
2. **é€šç”¨æ€§å¼º**: æ”¯æŒå¤šç§è¿è¡Œç¯å¢ƒå’Œä½¿ç”¨åœºæ™¯
3. **ç±»å‹å®‰å…¨**: å……åˆ†åˆ©ç”¨Rustç±»å‹ç³»ç»Ÿ
4. **åŠŸèƒ½å®Œæ•´**: åŒæ—¶æ”¯æŒæ–‡ä»¶ä¼ è¾“å’Œå®æ—¶èŠå¤©
5. **æ˜“äºæ‰©å±•**: è‰¯å¥½çš„æ‰©å±•ç‚¹å’Œæ¥å£è®¾è®¡

è¯¥å®ç°å·²ç»å…·å¤‡äº†ç”Ÿäº§ç¯å¢ƒä½¿ç”¨çš„åŸºç¡€ï¼Œé€šè¿‡æŒç»­çš„ä¼˜åŒ–å’Œæ”¹è¿›ï¼Œå¯ä»¥æˆä¸ºä¸€ä¸ªå¼ºå¤§çš„P2Pé€šä¿¡è§£å†³æ–¹æ¡ˆã€‚

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [APIæ–‡æ¡£](./README.md)
- [ä½¿ç”¨ç¤ºä¾‹](./examples/)
- [é›†æˆæŒ‡å—](../README.md)
- [æ€§èƒ½æµ‹è¯•](./benchmarks/)